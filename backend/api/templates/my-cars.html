{% extends 'base.html' %}
{% load static %}

{% block title %}My Car Listings{% endblock %}

{% block content %}
  <nav><a href="create-car.html">Create Car</a></nav>
  <h1>Your Car Listings</h1>
  <ul id="car-list"></ul>
{% endblock %}

{% block extra_js %}
  <script>
    async function loadMyCars() {
      try {
        const response = await fetch('http://localhost:8000/api/cars/mine/', {
          method: 'GET',
          headers: {
            'Content-Type': 'application/json',
            'Authorization': 'Bearer ' + localStorage.getItem('access_token'),
          },
        });
        const cars = await response.json();
        const list = document.getElementById('car-list');
        cars.forEach(car => {
          const li = document.createElement('li');
          li.innerHTML = `<strong>${car.make} ${car.model}</strong> - $${car.price_per_day}/day`;
          list.appendChild(li);
        });
      } catch (error) {
        console.error('Error fetching cars:', error);
      }
    }
    loadMyCars();
  </script>
{% endblock %}
